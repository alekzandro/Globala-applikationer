<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: api/middleware/authcheck.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: api/middleware/authcheck.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const cookieHandler = require('../cookieHandler')
const controller = require('../../controller/Controller')

/**

    Middleware that checks if the client who requested is logged in.
    If the user is logged in, it sets req.auth to true else false.
    It is important that this middleware is used before any routers!
    @async
    @function
    @param {Object} req - Express request object
    @param {Object} res - Express response object
    @param {Function} next - Express next function
    @throws {Error} Throws an error if there's an error while checking authentication
    @returns {void}
    */
const authCheck = async (req, res, next) => {
    try {
        const user = await cookieHandler.checkAuth(controller, req, res);
        if (!user){
            //user not logged in
            req.auth = null;
        } else {
            //user is logged in 
            req.auth = user;
        }
    } catch (error) {
        next(error);
    }
    next();
}

module.exports = authCheck;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-controller_Controller.html">controller/Controller</a></li><li><a href="module-routes_applicant.html">routes/applicant</a></li><li><a href="module-routes_create_application.html">routes/create_application</a></li></ul><h3>Classes</h3><ul><li><a href="Controller.html">Controller</a></li><li><a href="global.html#Person">Person</a></li><li><a href="Transactor.html">Transactor</a></li></ul><h3>Global</h3><ul><li><a href="global.html#authCheck">authCheck</a></li><li><a href="global.html#checkAuth">checkAuth</a></li><li><a href="global.html#commit">commit</a></li><li><a href="global.html#controller">controller</a></li><li><a href="global.html#rollback">rollback</a></li><li><a href="global.html#sendAuthCookie">sendAuthCookie</a></li><li><a href="global.html#startTransaction">startTransaction</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Wed Mar 08 2023 22:30:04 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
